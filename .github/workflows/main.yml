---
name: build/test/publish workflow.

on:
  push:
    branches:
      - '*'
    tags:
      - 'v[0-9]+\.[0-9]+\.[0-9]+'

jobs:
  test-and-deploy:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3

    - uses: actions/setup-java@v3
      with:
        distribution: temurin
        java-version: 8
        cache: maven
    - name: Build with Maven
      run: mvn -B clean install --file pom.xml 
      # output is target/omw-1.0-SNAPSHOT/**
      
    - uses: 'google-github-actions/auth@v2'
      with:
#        workload_identity_provider: 'projects/123456789/locations/global/workloadIdentityPools/my-pool/providers/my-provider'
        service_account: 'oauthuserinfo@appspot.gserviceaccount.com'

    - uses: 'google-github-actions/deploy-appengine@v2'
      with:
        project_id: oauthuserinfo
      

...
